# @file
# @brief System/package paths
# @description
# To support tests, multiple package locations or custom repackaging, most of the file system paths describing the 
# package installation can be reconfigured dynamically. This file containes several variable definitions specifying
# certain aspects of the packages' system installation.  
# These paths are:
# - `FS_ROOT`: Where the 'root' of the file system is. Usually '/'. Most paths of the package are defined to resolve against this.
# - `CONFIG_ROOT`: Directory where all config files of the package are placed. Contains the files generated by btc-config.
# - `DROPIN_DIR`: Normally a sub-dir of `$CONFIG_ROOT` - this is where users and devs should place additional files.
# - `BTC_PKG_DIR`: Where `btc-config` and the `support` directory is placed.
# - `BTC_BIN_DIR`: Where the 'real' emulationstation (and its core resources) is located. Default: `$BTC_PKG_DIR/bin`.
# - `BTC_SYSRES_DIR`: Path for additional, system wide resources like themes.
# - `EL_PKG_DIR`: Files related to emulatorlauncher ONLY.
# - `SH_LIB_DIR`: Generic shell helper files, used by both emulatorlauncher AND other support scripts.
#  
# The trickiest part in all scripts using this is that they first need to find the correct path to this file, relative
# to the package location. This usually means that `$FS_ROOT` has to be recalculated or hardcoded in at least one initial
# startup file.  
# There normally should be no need to change anything in this file, all paths are resolved either by supplying them 
# in the environment, or by using internal defaults which are all defined as sub-directories of `$FS_ROOT`.
#  
# **Notes:**  
# 1. Aside from a few files expected to be placed in `$FS_ROOT/usr/bin`, this file is the sole exception to the 
#    flexible package directories approach as it is THE central path configurator.  
#    It **must** be placed as `$FS_ROOT/etc/batocera-paths.conf`.
# 2. Although the file ends with `.conf`, it is NOT a valid '.conf' batocera property file.  
#    It is shell code so that it can handle values given from outside and combine them with defaults where needed.  
#    If desired, it is possible to hard-code any path, but the values have to be quoted correctly.

_scriptPath="$(readlink -f "${BASH_SOURCE[0]}")"
# when no FS_ROOT is given from outside, assume default package location and structure:
# this conf file will be placed under /etc directly.
FS_ROOT=${FS_ROOT:-${_scriptPath%/etc/batocera-paths.conf}}

# System-wide configuration directory
CONFIG_ROOT=${CONFIG_ROOT:-"${FS_ROOT%/}"/etc/batocera-emulationstation}
DROPIN_DIR=${DROPIN_DIR:-"$CONFIG_ROOT"/conf.d}

# Where btc-config and the real emulationstation bin folder is
BTC_PKG_DIR=${BTC_PKG_DIR:-"${FS_ROOT%/}"/opt/batocera-emulationstation}
BTC_BIN_DIR="${BTC_BIN_DIR:-"$BTC_PKG_DIR"/bin}"

# System-wide resources for batocera-emulationstation (additional themes etc)
BTC_SYSRES_DIR="${BTC_SYSRES_DIR:-"${FS_ROOT%/}"/usr/share/batocera-emulationstation}"

# Where emulatorlauncher pulls its adapters and private libraries from
EL_PKG_DIR=${EL_PKG_DIR:-"${FS_ROOT%/}"/opt/emulatorlauncher}

# generic shell library files
SH_LIB_DIR=${SH_LIB_DIR:-"$BTC_PKG_DIR"/lib}

export FS_ROOT \
  CONFIG_ROOT \
  DROPIN_DIR \
  BTC_PKG_DIR \
  BTC_BIN_DIR \
  BTC_SYSRES_DIR \
  EL_PKG_DIR \
  SH_LIB_DIR
